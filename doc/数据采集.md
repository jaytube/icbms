- [终端发送数据包格式](#终端发送数据包格式)
  - [数据类型](#数据类型)
    - [例1：实时数据-数据解析](#例1实时数据-数据解析)
      - [例1中实时数据其中data-数据解析](#例1中实时数据其中data-数据解析)
    - [例2：获取服务器时间-数据解析](#例2获取服务器时间-数据解析)
    - [例3：返回服务器时间响应-数据解析](#例3返回服务器时间响应-数据解析)
    - [例4：控制合分闸命令-数据解析](#例4控制合分闸命令-数据解析)
    - [例5：读取门限参数命令-数据解析](#例5读取门限参数命令-数据解析)
    - [例6：设置门限参数命令-数据解析](#例6设置门限参数命令-数据解析)
# 终端发送数据包格式
```text
1. 服务器通信地址端口: 119.96.233.75: 65003
2. TCP 数据 —> 16进制
```
## 数据类型
### 例1：实时数据-数据解析
```text
例1：实时数据：

1A 00 02 00 FC 01 00 00 00 01 90 00 00 00 00 01 4A 00 00 00 00 00 34
00 00 00 EA 00 DF 00 EC 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 01 1B 1C 00 02 00 00 01 00 1D 1A 00 02 00 FC 01
00 00 00 01 90 00 00 00 00 01 4A
```
|  数据包索引  |     位置属性      |                     原始值（16进制代码）                     |         解析值（实际意义值）         |
| :----------: | :---------------: | :----------------------------------------------------------: | :----------------------------------: |
|    第1位     | protoType指令类型 |                              1A                              | 26（网关主动上报实时数据与告警数据） |
| 第2位-第3位  |      网关ID       |                            00 02                             |                  2                   |
| 第4位-第5位  |      终端ID       |                            00  FC                            |                 252                  |
|    第6位     |       版本        |                              01                              |                  1                   |
| 第7位-第53位 |     data数组      | 00  00 00 01 90 00 00 00 00 01 4A 00 00 00 00 00 34 00 00 00 EA 00 DF 00 EC 00 00  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 |                                      |
|    第54位    |       跳过        |                              00                              |                                      |
|    第55位    |       结束        |                              1B                              |                                      |
|    剩下的    | 有字符，长度可变  |                                                              |                                      |
#### 例1中实时数据其中data-数据解析
|            数据包索引            | 原始值（16进制代码） |        指令        | server端计算方法                                             |
| :------------------------------: | :------------------: | :----------------: | :----------------------------------------------------------- |
|              第1位               |          00          |  Switch  address   |                                                              |
|              第2位               |          00          |   switch  on off   |                                                              |
|              第3位               |          00          |   Control  flag    |                                                              |
|           第4位-第5位            |        01  90        |      Voltage       | (short)(90 & 255 \| 01 << 8);                                |
|           第6位-第7位            |        00  00        |      Leakage       |                                                              |
|           第8位-第9位            |        00  00        |       Power        |                                                              |
|          第10位-第11位           |        01  4A        |    Temperature     | (short)(4A & 255 \| 01 << 8);                                |
|          第12位-第13位           |        00  00        |  Electric current  |                                                              |
|          第14位-第15位           |        00  00        |       Alarm        | "" +  (byte)(b >> 7 & 1) + (byte)(b >> 6 & 1) + (byte)(b  >> 5 & 1) + (byte)(b >> 4 & 1) + (byte)(b >> 3  & 1) + (byte)(b >> 2 & 1) + (byte)(b >> 1 & 1) +  (byte)(b >> 0 & 1) |
| 第16位-第15位-     第18位-第19位 |     00  34 00 00     |   Electric Count   | src[offset + 1]  & 255 \| (src[offset] & 255) << 8 \| (src[offset + 3] & 255)  << 16 \| (src[offset + 2] & 255) << 24; |
|          第20位-第21位           |          EA          |  Phase voltage A   |                                                              |
|          第22位-第23位           |        00  DF        |  Phase voltage B   |                                                              |
|          第24位-第25位           |        00  EC        |  Phase voltage C   |                                                              |
|          第26位-第27位           |        00 00         |  Phase voltage A   |                                                              |
|          第28位-第29位           |        00 00         |  Phase voltage B   |                                                              |
|          第30位-第31位           |        00 00         |  Phase voltage C   |                                                              |
|          第32位-第33位           |        00 00         |  Phase voltage N   |                                                              |
|          第34位-第35位           |        00 00         |  Phase voltage A   |                                                              |
|          第36位-第37位           |        00 00         |  Phase voltage B   |                                                              |
|          第38位-第39位           |        00 00         |  Phase voltage C   |                                                              |
|          第40位-第41位           |        00 00         |  Phase voltage A   |                                                              |
|          第42位-第43位           |        00 00         |  Phase voltage B   |                                                              |
|          第44位-第45位           |        00 00         |  Phase voltage C   |                                                              |
|              第46位              |          00          | Phase  alarm other |                                                              |
|              第47位              |          00          |    Lock status     |                                                              |
### 例2：获取服务器时间-数据解析
```text
例2：获取服务器时间

1C 00 02 00 00 01 00 1D 1A 00 02 00 FC 01 00 00 00 01 90 00 00 00 00 01 4A
```
| 数据包索引  | 位置属性  | 原始值（16进制代码） | 解析值（实际意义值） |
| :---------: | :-------: | :------------------: | :------------------: |
|    第1位    | protoType |          1C          | 获取服务器时间： 28  |
| 第2位-第3位 |  网关ID   |        00 02         |          2           |
| 第4位-第5位 |  终端ID   |        00 00         |         252          |
|    第6位    |   版本    |          01          |          1           |
|    第7位    |   跳过    |          00          |                      |
|    第8位    | 结束标志  |          1D          |          29          |
### 例3：返回服务器时间响应-数据解析
```text
例3：返回服务器时间响应

1C 00 02 00 00 01 0A 24 07 02 8E 00 1D
```

| 数据包索引    | 位置属性  | 原始值（16进制代码） | 解析值（实际意义值） |
| ------------- | --------- | -------------------- | -------------------- |
| 第1位         | protoType | 1C                   | 获取服务器时间： 28  |
| 第2位-第3位   | 网关ID    | 00 02                | 2                    |
| 第4位-第5位   | 终端ID    | 00 FC                | 252                  |
| 第6位         | 版本      | 01                   | 1                    |
| 第7位         | 小时      | 0A                   | 10                   |
| 第8位         | 分钟      | 24                   | 36                   |
| 第9位         | 秒        | 07                   | 7                    |
| 第10位-第11位 | 毫秒      | 02 8E                | 654                  |

### 例4：控制合分闸命令-数据解析
```text
例4：控制合分闸命令
    服务器发送 ->硬件

2A 00 02 00 FC 01 01 01 00 00 2B
```

| 数据包索引  | 位置属性  | 原始值（16进制代码） | 解析值（实际意义值） |
| :---------: | :-------: | :------------------: | :------------------: |
|    第1位    | protoType |          2A          |          42          |
| 第2位-第3位 |  网关ID   |        00 02         |          2           |
| 第4位-第5位 |  终端ID   |        00 FC         |         252          |
|    第6位    |   版本    |          01          |          1           |
|    第7位    | 线路地址  |          01          |                      |
|    第8位    | 开关分合  |          01          |                      |
|    第9位    | 门锁开关  |          00          |                      |
|   第10位    |   跳过    |          00          |                      |
|   第11位    |  停止位   |          2B          |                      |

### 例5：读取门限参数命令-数据解析
```text
例5：读取门限参数命令：
    服务器发送 ->硬件

4A 00 02 00 FC 01 01 01 04 00 00 4B
```

| 数据包索引  |    位置属性    | 原始值（16进制代码） |                     解析值（实际意义值）                     |
| :---------: | :------------: | :------------------: | :----------------------------------------------------------: |
|    第1位    |   protoType    |          2A          |                              42                              |
| 第2位-第3位 |     网关ID     |        00 02         |                              2                               |
| 第4位-第5位 |     终端ID     |        00 FC         |                             252                              |
|    第6位    |      版本      |          01          |                              1                               |
|    第7位    |    线路地址    |          01          |                                                              |
|    第8位    | 原485从机地址  |          01          |                                                              |
|    第9位    | 原485cmd功能码 |          04          |                                                              |
|   第10位    |    阀值类型    |          00          | 描述：00电压上限 01电压下限 02漏电流上限       03功率上限 04温度上限 05电流门限 |
|   第11位    |      跳过      |          00          |                                                              |
|   第12位    |     结束位     |          4B          |                              75                              |


### 例6：设置门限参数命令-数据解析
```text
例6：设置门限参数命令
    服务器发送 ->硬件

3A 00 02 00 FC 01 01 01 06 00 00 EE 00 3B
```

|  数据包索引   |            位置属性            | 原始值（16进制代码） |                     解析值（实际意义值）                     |
| :-----------: | :----------------------------: | :------------------: | :----------------------------------------------------------: |
|     第1位     |           protoType            |          2A          |                              42                              |
|  第2位-第3位  |             网关ID             |        00 02         |                              2                               |
|  第4位-第5位  |             终端ID             |        00 FC         |                             252                              |
|     第6位     |              版本              |          01          |                              1                               |
|     第7位     |            线路地址            |          01          |                                                              |
|     第8位     |         原485从机地址          |          01          |                                                              |
|     第9位     |          原485功能域           |          06          |                                                              |
|    第10位     |            阀值类型            |          00          | 描述：00电压上限 01电压下限 02漏电流上限       03功率上限 04温度上限 05电流门限 |
|    第11位     |  原485数据地址低位，空开地址   |          00          |                                                              |
| 第12位-第13位 | 具体电流或者电压或者温度的数值 |        00 EE         |                             238                              |
|    第14位     |              跳过              |          00          |                                                              |
|    第15位     |             结束位             |          3B          |                              59                              |